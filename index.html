<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOE English Master - K8 Đề số 4</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
      body { font-family: 'Nunito', sans-serif; }
      
      /* Custom Scrollbar */
      .custom-scrollbar::-webkit-scrollbar { width: 8px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
      
      /* Animations */
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
      
      @keyframes slideUp {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      .animate-slide-up { animation: slideUp 0.4s ease-out forwards; }

      @keyframes bounceShort {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
      }
      .animate-bounce-short { animation: bounceShort 1s infinite; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
<body class="bg-slate-100 text-slate-800 antialiased min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- 1. TYPES & ENUMS ---
        const QuestionType = {
            MULTIPLE_CHOICE: 'MULTIPLE_CHOICE',
            FILL_IN_BLANK: 'FILL_IN_BLANK',
            REARRANGE: 'REARRANGE'
        };

        const GameState = {
            START: 'START',
            PLAYING: 'PLAYING',
            FINISHED: 'FINISHED'
        };

        // --- 2. CONSTANTS & DATA ---
        const cleanUrl = (url) => {
            if (!url) return undefined;
            return url.trim()
                .replace(/\s+/g, '')
                .replace(/res\.ioe\.vnzedu/, 'res.ioe.vn/edu')
                .replace(/res\.ioe\.vii/, 'res.ioe.vn')
                .replace(/res\.ioe\.vm/, 'res.ioe.vn')
                .replace(/Audio\s*mp3/i, 'Audio.mp3')
                .replace(/ImageExam\s*(\d)/, 'ImageExam/$1')
                .replace(/Olympic\s*ExamData/, 'OlympicExamData')
                .replace(/EOlympic\s*ExamData/, 'EOlympic/ExamData')
                .replace(/'/g, '')
                .replace(/Audio-mp3/i, 'Audio.mp3');
        };

        const QUIZ_DATA = [
  { id: 1, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to reduce", "We should", "bottles", "reuse and recycle", "and cans", "garbage."], correctAnswer: "We should reuse and recycle bottles and cans to reduce garbage.", explanation: "Chúng ta nên tái sử dụng và tái chế chai lọ để giảm thiểu rác thải." },
  { id: 2, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["No one", "expected that", "of the company.", "he would be", "the president"], correctAnswer: "No one expected that he would be the president of the company.", explanation: "Không ai ngờ rằng anh ấy sẽ trở thành chủ tịch công ty." },
  { id: 3, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["and worse.", "is getting worse", "in the world", "The problem of", "food for everyone"], correctAnswer: "The problem of food for everyone in the world is getting worse and worse.", explanation: "Vấn đề lương thực cho mọi người trên thế giới ngày càng tồi tệ hơn." },
  { id: 4, type: QuestionType.MULTIPLE_CHOICE, questionText: "It is almost ... to park in the center of Newtown.", options: ["impossibility", "impossibilities", "impossible", "impossibly"], correctAnswer: "impossible", explanation: "It is + adj: Thật là... (không thể đỗ xe)." },
  { id: 5, type: QuestionType.FILL_IN_BLANK, questionText: "I can’t have anything to eat or drink for a long time before my _ _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/2/23/636865182352267091_Audio.mp3"), correctAnswer: "operation", explanation: "Operation: Ca phẫu thuật." },
  { id: 6, type: QuestionType.MULTIPLE_CHOICE, questionText: "We ___ to Ha Noi several times, but last summer we ___ by train.", options: ["flew – went", "has flown – went", "have flown – have gone", "have flown - went"], correctAnswer: "have flown - went", explanation: "Several times -> Present Perfect; Last summer -> Past Simple." },
  { id: 7, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["They took", "Hawaiian island", "to the", "a small plane", "of Oahu."], correctAnswer: "They took a small plane to the Hawaiian island of Oahu.", explanation: "Họ bắt một chiếc máy bay nhỏ đến đảo Oahu của Hawaii." },
  { id: 8, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently.", options: ["unite", "underline", "university", "uniform"], correctAnswer: "underline", explanation: "'Underline' /ʌ/, các từ còn lại /ju:/." },
  { id: 9, type: QuestionType.FILL_IN_BLANK, questionText: "The teacher asked me _ _ _ _  my name was and where I came from.", correctAnswer: "what", explanation: "Asked me what my name was: Hỏi tên tôi là gì." },
  { id: 10, type: QuestionType.MULTIPLE_CHOICE, questionText: "My cousin is 15 years old. She can’t drive a motorbike.", options: ["My cousin is too young that she can’t drive a motorbike.", "My cousin is too young to drive a motorbike.", "My cousin is young enough to drive a motorbike.", "My cousin isn’t old but she can drive a motorbike."], correctAnswer: "My cousin is too young to drive a motorbike.", explanation: "Too young to drive: Quá trẻ để lái xe." },
  { id: 11, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["in the", "island continent", "Australia", "South Pacific.", "is an"], correctAnswer: "Australia is an island continent in the South Pacific.", explanation: "Úc là một lục địa đảo ở Nam Thái Bình Dương." },
  { id: 12, type: QuestionType.FILL_IN_BLANK, questionText: "What was the name of the man arrested _ _  the police?", correctAnswer: "by", explanation: "Arrested by: Bị bắt bởi." },
  { id: 13, type: QuestionType.FILL_IN_BLANK, questionText: "What can you call a tool with sharp point and cutting edges for making holes in hard materials? – It must be a ’’_ _ _ _ _ ’’. ", correctAnswer: "drill", explanation: "Drill: Máy khoan." },
  { id: 14, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["his French", "What did", "to improve", "pronunciation?", "she tell him"], correctAnswer: "What did she tell him to improve his French pronunciation?", explanation: "Cô ấy đã bảo anh ta làm gì để cải thiện phát âm tiếng Pháp?" },
  { id: 15, type: QuestionType.MULTIPLE_CHOICE, questionText: "Find the word which has a different sound in the part underlined.", options: ["unique", "mosquito", "mosque", "question"], correctAnswer: "question", explanation: "'Question' /tʃ/, các từ còn lại /k/." },
  { id: 16, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ _  day of the week is the School’s festival day?", correctAnswer: "Which", explanation: "Which day: Ngày nào." },
  { id: 17, type: QuestionType.MULTIPLE_CHOICE, questionText: "I couldn’t make coffee for everybody. There weren’t ….", options: ["cups enough", "enough cups", "cups too", "too cups"], correctAnswer: "enough cups", explanation: "Enough + Noun: Đủ cốc." },
  { id: 18, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ _  child do you think he is?", correctAnswer: "Whose", explanation: "Whose child: Con của ai." },
  { id: 19, type: QuestionType.FILL_IN_BLANK, questionText: "She arrived early in order to _ _ _  a good seat.", correctAnswer: "get", explanation: "Get a good seat: Có chỗ ngồi tốt." },
  { id: 20, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Can you tell me", "what the weather", "so that I can", "bring suitable clothes?", "is like"], correctAnswer: "Can you tell me what the weather is like so that I can bring suitable clothes?", explanation: "Bạn có thể cho tôi biết thời tiết thế nào để tôi mang quần áo phù hợp không?" },
  { id: 21, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which part needs correction in the following sentence? I wasdrying the dishes when I was dropped the plate.", options: ["was", "drying", "when", "was dropped"], correctAnswer: "was dropped", explanation: "Sửa thành 'dropped' (Hành động cắt ngang)." },
  { id: 22, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the house.", "My mother", "clean", "make us", "used to"], correctAnswer: "My mother used to make us clean the house.", explanation: "Mẹ tôi thường bắt chúng tôi dọn dẹp nhà cửa." },
  { id: 23, type: QuestionType.MULTIPLE_CHOICE, questionText: "Rewrite the sentence with the same meaning: Do you find it easy to make friends? --> Are you ___?", options: ["good at making friends", "bad at making friends", "prefer making friends", "scared of making friends"], correctAnswer: "good at making friends", explanation: "Find easy ~ Good at." },
  { id: 24, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to see", "terrible cough,", "With that", "Linda had", "a doctor."], correctAnswer: "With that terrible cough, Linda had to see a doctor.", explanation: "Với cơn ho khủng khiếp đó, Linda phải đi khám bác sĩ." },
  { id: 25, type: QuestionType.MULTIPLE_CHOICE, questionText: "“Scared” has similar meaning to “...”.", options: ["bored", "tired", "frightened", "fond"], correctAnswer: "frightened", explanation: "Scared = Frightened: Sợ hãi." },
  { id: 26, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["action", "Do you", "enjoy", "films?", "watching"], correctAnswer: "Do you enjoy watching action films?", explanation: "Bạn có thích xem phim hành động không?" },
  { id: 27, type: QuestionType.MULTIPLE_CHOICE, questionText: "“Phone him tomorrow,” she said to me.", options: ["She said to me to phone him tomorrow.", "She said to me that phone him the following day.", "She told me to phone him the following day.", "She told to me for phoning him the following day."], correctAnswer: "She told me to phone him the following day.", explanation: "Tường thuật câu mệnh lệnh: told sb to do sth." },
  { id: 28, type: QuestionType.FILL_IN_BLANK, questionText: "How often do your parents _ _  camping? – Every weekend.", correctAnswer: "go", explanation: "Go camping: Đi cắm trại." },
  { id: 29, type: QuestionType.FILL_IN_BLANK, questionText: "My car was made _ _  Japan, you know?", correctAnswer: "in", explanation: "Made in: Được sản xuất tại." },
  { id: 30, type: QuestionType.MULTIPLE_CHOICE, questionText: "Can I borrow you marker, Giang?, said Tung.", options: ["Tung asked if Giang could lend him her marker.", "Tung said whether he could borrow Giang's marker.", "Tung wanted to lend Giang his marker.", "Tung wanted Giang to lend him her marker."], correctAnswer: "Tung asked if Giang could lend him her marker.", explanation: "Tường thuật câu xin phép/đề nghị." },
  { id: 31, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["one of", "the most", "interesting people", "I’ve met.", "He is"], correctAnswer: "He is one of the most interesting people I’ve met.", explanation: "Anh ấy là một trong những người thú vị nhất tôi từng gặp." },
  { id: 32, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["and pine hills.", "is the valley", "of various flowers", "the Prenn Falls", "Around"], correctAnswer: "Around the Prenn Falls is the valley of various flowers and pine hills.", explanation: "Xung quanh thác Prenn là thung lũng hoa và đồi thông." },
  { id: 33, type: QuestionType.MULTIPLE_CHOICE, questionText: "It was very hot, ... I opened all the windows.", options: ["because", "but", "so", "when"], correctAnswer: "so", explanation: "So: Vì vậy." },
  { id: 34, type: QuestionType.FILL_IN_BLANK, questionText: "A _ _ _ _ _ _ _  occurs after a rainstorm, when the sun shines.", correctAnswer: "rainbow", explanation: "Rainbow: Cầu vồng." },
  { id: 35, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which sentence is incorrect?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/4/10/636589473912399403_Audio.mp3"), options: ["The Panama Canal is man-made.", "The Panama Canal is in South America.", "The Panama Canal connects the Atlantic Ocean and Pacific Ocean.", "Building the Panama Canal started in 1881."], correctAnswer: "The Panama Canal is in South America.", explanation: "Kênh đào Panama ở Trung Mỹ, không phải Nam Mỹ." },
  { id: 36, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["My father", "told me", "go", "not to", "too far."], correctAnswer: "My father told me not to go too far.", explanation: "Bố bảo tôi đừng đi quá xa." },
  { id: 37, type: QuestionType.FILL_IN_BLANK, questionText: "Neither Peter _ _ _  his friends have finished their test yet.", correctAnswer: "nor", explanation: "Neither... nor..." },
  { id: 38, type: QuestionType.FILL_IN_BLANK, questionText: "A _ _ _  days after the interview, I received a letter offering me the job.", correctAnswer: "few", explanation: "A few days: Vài ngày." },
  { id: 39, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has different stress pattern:", options: ["fertilize", "knowledge", "recycle", "dangerous"], correctAnswer: "recycle", explanation: "'Recycle' nhấn âm 2, các từ còn lại nhấn âm 1." },
  { id: 40, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["go hill", "I often", "for", "walking", "relaxation."], correctAnswer: "I often go hill walking for relaxation.", explanation: "Tôi thường đi bộ leo đồi để thư giãn." },
  { id: 41, type: QuestionType.FILL_IN_BLANK, questionText: "This is my first visit to Hong Kong. I’ve never been here _ _ _ _ _ _ .", correctAnswer: "before", explanation: "Before: Trước đây." },
  { id: 42, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["was opened", "week.", "A new restaurant", "on Main Street", "last"], correctAnswer: "A new restaurant was opened on Main Street last week.", explanation: "Một nhà hàng mới đã được mở trên phố Main tuần trước." },
  { id: 43, type: QuestionType.FILL_IN_BLANK, questionText: "Thai people have followed the xoe dance as a _ _ _ _ _ _ _ _ _  tradition for generations.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/4/10/636589563922761279_Audio.mp3"), correctAnswer: "spiritual", explanation: "Spiritual: Tâm linh/tinh thần." },
  { id: 44, type: QuestionType.FILL_IN_BLANK, questionText: "The house _ _ _  built three years ago.", correctAnswer: "was", explanation: "Was built: Được xây." },
  { id: 45, type: QuestionType.FILL_IN_BLANK, questionText: "Students are _ _ _  allowed to cheat in exams.", correctAnswer: "not", explanation: "Not allowed: Không được phép." },
  { id: 46, type: QuestionType.FILL_IN_BLANK, questionText: "This area of the country is mostly _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/1/13/636199092302476568_Audio.mp3"), correctAnswer: "rural", explanation: "Rural: Nông thôn." },
  { id: 47, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _  plus five makes ten.", correctAnswer: "Five", explanation: "Five plus five: 5 + 5." },
  { id: 48, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["It is a", "city center.", "to the", "thirty-minute drive", "from here"], correctAnswer: "It is a thirty-minute drive from here to the city center.", explanation: "Mất 30 phút lái xe từ đây vào trung tâm." },
  { id: 49, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ _ _  usually refers to a professional writer.", correctAnswer: "Author", explanation: "Author: Tác giả." },
  { id: 50, type: QuestionType.FILL_IN_BLANK, questionText: "A _ _ _ _ _ _ _  is a person who is forced to leave a country.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/4/10/636589466849260374_Audio.mp3"), correctAnswer: "refugee", explanation: "Refugee: Người tị nạn." },
  { id: 51, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to catch", "bus.", "We were", "the last", "lucky"], correctAnswer: "We were lucky to catch the last bus.", explanation: "Chúng tôi may mắn bắt được chuyến xe buýt cuối cùng." },
  { id: 52, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["“Open-air Opera House”,", "known as", "a lot of visitors.", "a symbol of Australia,", "attracts"], correctAnswer: "Known as “Open-air Opera House”, a symbol of Australia, attracts a lot of visitors.", explanation: "Được biết đến như nhà hát Opera ngoài trời..." },
  { id: 53, type: QuestionType.MULTIPLE_CHOICE, questionText: "… did it take you to finish the project? – Just one day.", options: ["How many", "How much", "How long", "How often"], correctAnswer: "How long", explanation: "How long: Bao lâu." },
  { id: 54, type: QuestionType.MULTIPLE_CHOICE, questionText: "My younger sister was ... for days after the accident.", options: ["conscious", "unconscious", "consciously", "unconsciously"], correctAnswer: "unconscious", explanation: "Unconscious: Bất tỉnh." },
  { id: 55, type: QuestionType.MULTIPLE_CHOICE, questionText: "He thinks that ... on the Internet is a waste of time.", options: ["chat", "chatting", "chatter", "to chat"], correctAnswer: "chatting", explanation: "Chatting: Việc tán gẫu (Danh động từ làm chủ ngữ)." },
  { id: 56, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["100 kilometers away.", "is big enough", "Mount Rushmore", "more than", "to be seen"], correctAnswer: "Mount Rushmore is big enough to be seen from more than 100 kilometers away.", explanation: "Núi Rushmore đủ lớn để nhìn thấy từ xa hơn 100km." },
  { id: 57, type: QuestionType.MULTIPLE_CHOICE, questionText: "Quynh spends most of her free time ... volunteer work.", options: ["do", "to do", "doing", "for doing"], correctAnswer: "doing", explanation: "Spend time doing something." },
  { id: 58, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["when they are", "at school.", "high school girls", "should wear “Ao dai”", "My opinion is that"], correctAnswer: "My opinion is that high school girls should wear “Ao dai” when they are at school.", explanation: "Ý kiến của tôi là nữ sinh trung học nên mặc áo dài..." },
  { id: 59, type: QuestionType.FILL_IN_BLANK, questionText: "Most American television programs _ _ _  produced in Hollywood.", correctAnswer: "are", explanation: "Are produced: Được sản xuất." },
  { id: 60, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["with women?", "men share housework", "How much do", "care of children", "and the"], correctAnswer: "How much do men share housework and the care of children with women?", explanation: "Đàn ông chia sẻ việc nhà và chăm sóc con cái với phụ nữ bao nhiêu?" },
  { id: 61, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to avoid them.", "to read about", "It’s important", "home accident", "and how"], correctAnswer: "It’s important to read about home accident and how to avoid them.", explanation: "Quan trọng là đọc về tai nạn trong nhà và cách phòng tránh." },
  { id: 62, type: QuestionType.FILL_IN_BLANK, questionText: "A schoolboy wears his _ _ _ _ _ _ _  so that people know which school he goes to.", correctAnswer: "uniform", explanation: "Uniform: Đồng phục." },
  { id: 63, type: QuestionType.MULTIPLE_CHOICE, questionText: "My teacher advised ... listening whenever I have free time.", options: ["me practice", "me to practice", "I practice", "I to practice"], correctAnswer: "me to practice", explanation: "Advise sb to do sth." },
  { id: 64, type: QuestionType.MULTIPLE_CHOICE, questionText: "We arrived on time … the traffic was bad.", options: ["although", "even", "in spite of", "despite"], correctAnswer: "although", explanation: "Although + clause." },
  { id: 65, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["when his brother arrives", "to a peaceful weekend", "with all his friends", "from the football club.", "Martin is looking forward"], correctAnswer: "Martin is looking forward to a peaceful weekend when his brother arrives with all his friends from the football club.", explanation: "Martin đang mong chờ kỳ nghỉ cuối tuần yên bình..." },
  { id: 66, type: QuestionType.FILL_IN_BLANK, questionText: "I’m stuck _ _  a traffic jam.", correctAnswer: "in", explanation: "Stuck in: Kẹt trong." },
  { id: 67, type: QuestionType.FILL_IN_BLANK, questionText: "You need not only to fill your ca_ _ _ _ _ _  but to pull your decayed teeth.", correctAnswer: "vities", explanation: "Cavities: Lỗ sâu răng." },
  { id: 68, type: QuestionType.FILL_IN_BLANK, questionText: "I’m afraid you’ve misunderstood me because that’s not _ _ _ _  I meant.", correctAnswer: "what", explanation: "What I meant: Điều tôi muốn nói." },
  { id: 69, type: QuestionType.MULTIPLE_CHOICE, questionText: "It’s getting ... and darker so be careful on your way back.", options: ["dark", "darker", "darkly", "to be dark"], correctAnswer: "darker", explanation: "Darker and darker: Ngày càng tối." },
  { id: 70, type: QuestionType.FILL_IN_BLANK, questionText: "Whenever I watch the news on TV, I see places that are flooded or affected by _ _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2020/1/10/637142323865114771_Audio.mp3"), correctAnswer: "drought", explanation: "Drought: Hạn hán." },
  { id: 71, type: QuestionType.FILL_IN_BLANK, questionText: "You can’t get some medicines without a doctor’s _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/1/11/636828191061962766_Audio.mp3"), correctAnswer: "prescription", explanation: "Prescription: Đơn thuốc." },
  { id: 72, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["about", "to learn", "Binef", "wants", "auto mechanics."], correctAnswer: "Binef wants to learn about auto mechanics.", explanation: "Binef muốn học về cơ khí ô tô." },
  { id: 73, type: QuestionType.MULTIPLE_CHOICE, questionText: ".“Do you want to visit London?\", said Mai", options: ["Mai asked me if I wanted to visit London.", "Mai wanted to know if she visited London.", "Mai wondered me whether I wanted to visit London.", "Mai said to me about my visiting London."], correctAnswer: "Mai asked me if I wanted to visit London.", explanation: "Tường thuật câu hỏi Yes/No." },
  { id: 74, type: QuestionType.MULTIPLE_CHOICE, questionText: "What were you doing when the light went you? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/1/7/635247067607069608_Audio.mp3"), options: ["I was tasting a cake", "I was doing a cake", "I was making a cake", "I was laying the cake"], correctAnswer: "I was making a cake", explanation: "Nghe audio." },
  { id: 75, type: QuestionType.FILL_IN_BLANK, questionText: "How often do your parents _ _  camping? – Every weekend.", correctAnswer: "go", explanation: "Go camping: Đi cắm trại." },
  { id: 76, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["left Vietnam in 1911.", "Nha Rong Harbor because", "it is the place where", "John should go to", "President Ho Chi Minh"], correctAnswer: "John should go to Nha Rong Harbor because it is the place where President Ho Chi Minh left Vietnam in 1911.", explanation: "John nên đến Bến Nhà Rồng..." },
  { id: 77, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["is one of", "The Amazon", "longest rivers", "the", "in the world."], correctAnswer: "The Amazon is one of the longest rivers in the world.", explanation: "Sông Amazon là một trong những con sông dài nhất thế giới." },
  { id: 78, type: QuestionType.FILL_IN_BLANK, questionText: "People didn’t talk on the phone one hundred years _ _ _ .", correctAnswer: "ago", explanation: "Ago: Trước đây." },
  { id: 79, type: QuestionType.FILL_IN_BLANK, questionText: "Driving _ _  the left is very dangerous in our country.", correctAnswer: "on", explanation: "On the left: Bên trái." },
  { id: 80, type: QuestionType.FILL_IN_BLANK, questionText: "Mary is _ _  intelligent that she can answer all the questions.", correctAnswer: "so", explanation: "So... that..." },
  { id: 81, type: QuestionType.FILL_IN_BLANK, questionText: "How many lessons have you studied _ _  to now?", correctAnswer: "up", explanation: "Up to now: Cho đến nay." },
  { id: 82, type: QuestionType.FILL_IN_BLANK, questionText: "To obtain the best result, mix the powder _ _ _ _  warm water.", correctAnswer: "with", explanation: "Mix with: Trộn với." },
  { id: 83, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word whose underlined part is pronounced differently from other:", options: ["handles", "hits", "checks", "stops"], correctAnswer: "handles", explanation: "'Handles' /z/, các từ còn lại /s/." },
  { id: 84, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["twice", "tennis", "picnic", "skip"], correctAnswer: "twice", explanation: "'Twice' /aɪ/, các từ còn lại /ɪ/." },
  { id: 85, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["It was", "to help", "very kind of", "you", "me."], correctAnswer: "It was very kind of you to help me.", explanation: "Bạn thật tốt bụng khi giúp tôi." },
  { id: 86, type: QuestionType.MULTIPLE_CHOICE, questionText: "When she was young, she … do a lot of exercises.", options: ["used to", "wasn’t used to", "was used to", "was use to"], correctAnswer: "used to", explanation: "Used to: Đã từng." },
  { id: 87, type: QuestionType.MULTIPLE_CHOICE, questionText: "When do English people often eat salad?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/3/1/636555205464136165_Audio.mp3"), options: ["Winter", "Summer", "Cold weather", "Fall"], correctAnswer: "Summer", explanation: "Nghe audio." },
  { id: 88, type: QuestionType.FILL_IN_BLANK, questionText: "He is old enough to take _ _ _ _  of himself.", correctAnswer: "care", explanation: "Take care of: Chăm sóc." },
  { id: 89, type: QuestionType.MULTIPLE_CHOICE, questionText: "What do members living near school do? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302334401020819_Audio.mp3"), options: ["Volunteer to talk about the school", "Volunteer to take a walk to school", "Volunteer to ask for school", "Volunteer to watch the school"], correctAnswer: "Volunteer to talk about the school", explanation: "Nghe audio." },
  { id: 90, type: QuestionType.MULTIPLE_CHOICE, questionText: "She said: \"One day I will be able to continue my studies.\"", options: ["She said she would be able to continue her studies one day.", "She said she would be able to continue my studies.", "She said I would be able to continue my studies.", "She said she will be able to continue her studies."], correctAnswer: "She said she would be able to continue her studies one day.", explanation: "Tường thuật: I -> she, will -> would, my -> her." },
  { id: 91, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["not enough", "back home", "There was", "by bike.", "time to go"], correctAnswer: "There was not enough time to go back home by bike.", explanation: "Không đủ thời gian để đạp xe về nhà." },
  { id: 92, type: QuestionType.MULTIPLE_CHOICE, questionText: "I arrived _____ home at ten fifteen last night.", options: ["in", "at", "from", "Ø"], correctAnswer: "Ø", explanation: "Arrive home (không có giới từ)." },
  { id: 93, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["handicrafts.", "on", "on doing", "projects", "He is keen"], correctAnswer: "He is keen on doing projects on handicrafts.", explanation: "Anh ấy thích làm các dự án thủ công." },
  { id: 94, type: QuestionType.MULTIPLE_CHOICE, questionText: "Nam’s father usually ... pigs and chickens every morning.", options: ["collects", "feeds", "works", "grows"], correctAnswer: "feeds", explanation: "Feeds: Cho ăn." },
  { id: 95, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word whose main stress pattern is not the same as that of the others:", options: ["destroy", "despite", "describe", "destiny"], correctAnswer: "destiny", explanation: "'Destiny' nhấn âm 1, các từ còn lại nhấn âm 2." },
  { id: 96, type: QuestionType.FILL_IN_BLANK, questionText: "Who is the main _ _ _ _ _ _ _ _ _  in the story “The Adventures of Pinocchio”?", correctAnswer: "character", explanation: "Main character: Nhân vật chính." },
  { id: 97, type: QuestionType.FILL_IN_BLANK, questionText: "I went to the hair dresser to have my hair _ _ _  this morning.", correctAnswer: "cut", explanation: "Have hair cut: Cắt tóc." },
  { id: 98, type: QuestionType.FILL_IN_BLANK, questionText: "Linda isn’t home at _ _ _ _ _ nt. Can you call her later?", correctAnswer: "prese", explanation: "At present: Hiện tại." },
  { id: 99, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently.", options: ["wrap", "trash", "spray", "category"], correctAnswer: "spray", explanation: "'Spray' /eɪ/, các từ còn lại /æ/." },
  { id: 100, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["is one of", "the world.", "Aesop’s famous", "fables for children in", "“The Tortoise and the Hare”"], correctAnswer: "“The Tortoise and the Hare” is one of Aesop’s famous fables for children in the world.", explanation: "Rùa và Thỏ là một trong những truyện ngụ ngôn nổi tiếng..." },
  { id: 101, type: QuestionType.FILL_IN_BLANK, questionText: "Today natural gas is stored in large tanks and _ _ _ _  for lighting, cooking and heating.", correctAnswer: "used", explanation: "Used for: Được dùng để." },
  { id: 102, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["this mistake", "us to report", "Will it be", "necessary for", "to the teacher?"], correctAnswer: "Will it be necessary for us to report this mistake to the teacher?", explanation: "Liệu có cần thiết để chúng ta báo cáo lỗi này với giáo viên không?" },
  { id: 103, type: QuestionType.FILL_IN_BLANK, questionText: "These medicines can help re_ _ _ ve the symptoms of the flu.", correctAnswer: "lie", explanation: "Relieve: Giảm nhẹ." },
  { id: 104, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["for fertilizing", "Farmers grow food", "for their animals", "their fields.", "and use the dung"], correctAnswer: "Farmers grow food for their animals and use the dung for fertilizing their fields.", explanation: "Nông dân trồng thức ăn cho gia súc và dùng phân bón ruộng." },
  { id: 105, type: QuestionType.MULTIPLE_CHOICE, questionText: "Mr Parker should go to the doctor, ______?", options: ["shouldn’t him", "shouldn’t Mr Parker", "shouldn’t he", "doesn’t he"], correctAnswer: "shouldn’t he", explanation: "Câu hỏi đuôi với should." },
  { id: 106, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the street.", "around", "wandering", "much time", "We spent"], correctAnswer: "We spent much time wandering around the street.", explanation: "Chúng tôi dành nhiều thời gian lang thang trên phố." },
  { id: 107, type: QuestionType.MULTIPLE_CHOICE, questionText: "… seeing beautiful sites, visitors enjoy traditional food.", options: ["According to", "Together", "Apart", "As well as"], correctAnswer: "As well as", explanation: "As well as: Cũng như/Ngoài ra." },
  { id: 108, type: QuestionType.MULTIPLE_CHOICE, questionText: "How are you feeling today? - ….", options: ["Yes", "Thank you", "I’m sorry", "Not too bad"], correctAnswer: "Not too bad", explanation: "Not too bad: Không tệ lắm." },
  { id: 109, type: QuestionType.FILL_IN_BLANK, questionText: "Charles Dickens was born _ _  a poor clerk family.", correctAnswer: "into", explanation: "Born into: Sinh ra trong." },
  { id: 110, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently.", options: ["rest", "relax", "emigrate", "academic"], correctAnswer: "academic", explanation: "'Academic' /æ/, các từ còn lại /e/ hoặc /ɪ/." },
  { id: 111, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["that it's", "for you", "a difficult decision", "to make.", "I appreciate"], correctAnswer: "I appreciate that it's a difficult decision for you to make.", explanation: "Tôi hiểu rằng đó là một quyết định khó khăn với bạn." },
  { id: 112, type: QuestionType.FILL_IN_BLANK, questionText: "_ _  Vietnam, there are more and more families having cable TV.", correctAnswer: "In", explanation: "In Vietnam." },
  { id: 113, type: QuestionType.MULTIPLE_CHOICE, questionText: "It took me a long time to get used … glasses.", options: ["to wear", "to wearing", "wear", "wore"], correctAnswer: "to wearing", explanation: "Get used to + V-ing." },
  { id: 114, type: QuestionType.FILL_IN_BLANK, questionText: "“Repair” has similar meaning to “_ _ _ ”.", correctAnswer: "fix", explanation: "Fix/Mend." },
  { id: 115, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["When", "his house,", "he", "I entered", "was cooking."], correctAnswer: "When I entered his house, he was cooking.", explanation: "Khi tôi vào nhà, anh ấy đang nấu ăn." },
  { id: 116, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["horrible", "uniform", "order", "author"], correctAnswer: "horrible", explanation: "'Horrible' /ɒ/, các từ còn lại /ɔː/." },
  { id: 117, type: QuestionType.FILL_IN_BLANK, questionText: "People are not aware _ _  the problem of overpopulation.", correctAnswer: "of", explanation: "Aware of: Nhận thức về." },
  { id: 118, type: QuestionType.FILL_IN_BLANK, questionText: "It was very uncomfortable to sit in one place for so _ _ _ _ .", correctAnswer: "long", explanation: "For so long: Quá lâu." },
  { id: 119, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["and scientist discoveries.", "at modern inventions", "and he would like to", "spend a day looking", "Mr. Binh is an engineer"], correctAnswer: "Mr. Binh is an engineer and he would like to spend a day looking at modern inventions and scientist discoveries.", explanation: "Ông Bình là kỹ sư và ông ấy muốn dành một ngày..." },
  { id: 120, type: QuestionType.MULTIPLE_CHOICE, questionText: "Could you ... the radio, please? It’s too noisy and I want to have a nap.", options: ["turn on", "close up", "turn off", "close off"], correctAnswer: "turn off", explanation: "Turn off: Tắt." },
  { id: 121, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["under the fireworks", ", they’re", "so sparkling.", "to stand", "I love"], correctAnswer: "I love to stand under the fireworks, they’re so sparkling.", explanation: "Tôi thích đứng dưới pháo hoa..." },
  { id: 122, type: QuestionType.FILL_IN_BLANK, questionText: "’’Congratulations!’’ John _ _ _ _  to me yesterday.", correctAnswer: "said", explanation: "Said to me." },
  { id: 123, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which sentence is incorrect?", options: ["She helps me to choose a shirt.", "Your explanation helps me to understand the problem.", "Thank for help me cleaning the car.", "Let me help you."], correctAnswer: "Thank for help me cleaning the car.", explanation: "Sai ngữ pháp: Thanks for helping me clean..." },
  { id: 124, type: QuestionType.FILL_IN_BLANK, questionText: "This is the first time I have _ _ _ _  seen snow.", correctAnswer: "ever", explanation: "Have ever seen." },
  { id: 125, type: QuestionType.FILL_IN_BLANK, questionText: "I like reading books by Jack London, and so _ _ _ _  my brother.", correctAnswer: "does", explanation: "So does my brother: Anh tôi cũng vậy." },
  { id: 126, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and tick:", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302353261297946_Audio.mp3"), options: ["There are many people in the restaurant.", "There were many people in the restaurant.", "There aren’t many people in the restaurant.", "There weren’t many people in the restaurant."], correctAnswer: "There are many people in the restaurant.", explanation: "Nghe audio." },
  { id: 127, type: QuestionType.FILL_IN_BLANK, questionText: "Areas around the Cuu Long delta can _ _ _ _ _ _ _ _  clouds during the day.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/29/635213227700203512_Audio.mp3"), correctAnswer: "generate", explanation: "Generate clouds: Tạo ra mây." },
  { id: 128, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["where both", "Montreal", "are spoken.", "French and English", "is a city"], correctAnswer: "Montreal is a city where both French and English are spoken.", explanation: "Montreal là thành phố nói cả tiếng Anh và Pháp." },
  { id: 129, type: QuestionType.MULTIPLE_CHOICE, questionText: "I put the heater on ... the food warm.", options: ["keep", "keeping", "to keep", "for keeping"], correctAnswer: "to keep", explanation: "To keep: Để giữ." },
  { id: 130, type: QuestionType.FILL_IN_BLANK, questionText: "Many of di_ _ _ _ _ _ _  had short tails, big heads and walked on four legs.", correctAnswer: "nosaurs", explanation: "Dinosaurs: Khủng long." },
  { id: 131, type: QuestionType.FILL_IN_BLANK, questionText: "No animals runs so fast _ _  the cheetah.", correctAnswer: "as", explanation: "So... as...: So sánh bằng." },
  { id: 132, type: QuestionType.MULTIPLE_CHOICE, questionText: "Will you come to the party tomorrow? - I will if I … no visitors.", options: ["have", "will have", "had", "am having"], correctAnswer: "have", explanation: "Câu điều kiện loại 1." },
  { id: 133, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which sentence is correct?", options: ["I’m hungry. I am like some meat and rice.", "I’m hungry. I’d like some meat and rice.", "I’d hungry. I am like some meat and rice.", "I like hungry. I’d like some meat and rice."], correctAnswer: "I’m hungry. I’d like some meat and rice.", explanation: "I'd like = I would like." },
  { id: 134, type: QuestionType.FILL_IN_BLANK, questionText: "As far as I _ _ _ _ , the bridge is going to be reconstructed by a foreign company.", correctAnswer: "know", explanation: "As far as I know: Theo tôi được biết." },
  { id: 135, type: QuestionType.MULTIPLE_CHOICE, questionText: "What does David’s father think about Maths and English?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/1/13/636199064121882345_Audio.mp3"), options: ["They are important school subjects.", "They are difficult school subjects.", "They aren’t important school subjects.", "They are boring school subjects."], correctAnswer: "They are important school subjects.", explanation: "Nghe audio." },
  { id: 136, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["for me", "impossible", "case.", "It is", "to lift that"], correctAnswer: "It is impossible for me to lift that case.", explanation: "Tôi không thể nhấc cái thùng đó." },
  { id: 137, type: QuestionType.FILL_IN_BLANK, questionText: "Cyberbullying can happen _ _  anyone.", correctAnswer: "to", explanation: "Happen to: Xảy ra với." },
  { id: 138, type: QuestionType.FILL_IN_BLANK, questionText: "Her appearance was quite different _ _ _ _  what I had expected.", correctAnswer: "from", explanation: "Different from: Khác với." },
  { id: 139, type: QuestionType.FILL_IN_BLANK, questionText: "She walks to school. It means she goes to school on _ _ _ _ .", correctAnswer: "foot", explanation: "On foot: Đi bộ." },
  { id: 140, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["The door", "being", "painted", "by him.", "is"], correctAnswer: "The door is being painted by him.", explanation: "Cánh cửa đang được anh ấy sơn." },
  { id: 141, type: QuestionType.FILL_IN_BLANK, questionText: "Mr. Robinson teaches us _ _ _  to speak Spanish fluently.", correctAnswer: "how", explanation: "How to: Cách để." },
  { id: 142, type: QuestionType.FILL_IN_BLANK, questionText: "Tom had a terrible experience _ _ _ _  Saturday.", correctAnswer: "last", explanation: "Last Saturday." },
  { id: 143, type: QuestionType.MULTIPLE_CHOICE, questionText: "The glass of water fell on the floor and broke ….", options: ["in piece", "into half", "into pieces", "out to pieces"], correctAnswer: "into pieces", explanation: "Into pieces: Vỡ tan." },
  { id: 144, type: QuestionType.FILL_IN_BLANK, questionText: "I haven’t met my grandparents _ _ _  2 years.", correctAnswer: "for", explanation: "For + khoảng thời gian." },
  { id: 145, type: QuestionType.MULTIPLE_CHOICE, questionText: "He has written four novels ....", options: ["so far", "one year ago", "last year", "yesterday"], correctAnswer: "so far", explanation: "So far: Cho đến nay (Hiện tại hoàn thành)." },
  { id: 146, type: QuestionType.FILL_IN_BLANK, questionText: "Van is an international student in _ _ _  USA.", correctAnswer: "the", explanation: "The USA." },
  { id: 147, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently.", options: ["invented", "visited", "washed", "rested"], correctAnswer: "washed", explanation: "'Washed' /t/, các từ còn lại /id/." },
  { id: 148, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["cap", "paddy", "woman", "crab"], correctAnswer: "woman", explanation: "'Woman' /ʊ/, các từ còn lại /æ/." },
  { id: 149, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the college", "get the", "office?", "tickets from", "Can you"], correctAnswer: "Can you get the tickets from the college office?", explanation: "Bạn có thể lấy vé từ văn phòng trường không?" },
  { id: 150, type: QuestionType.MULTIPLE_CHOICE, questionText: "I can remember … a strange noise in the middle of the night.", options: ["hear", "heard", "hearing", "to hear"], correctAnswer: "hearing", explanation: "Remember doing: Nhớ đã làm gì." },
  { id: 151, type: QuestionType.MULTIPLE_CHOICE, questionText: "Thu ate so much chocolate ... she gains weight quickly.", options: ["that", "because", "since", "for"], correctAnswer: "that", explanation: "So... that...: Quá... đến nỗi..." },
  { id: 152, type: QuestionType.MULTIPLE_CHOICE, questionText: "The cold “cures” don’t cure a cold, but they ... the symptoms.", options: ["prevent", "relieve", "help", "bring"], correctAnswer: "relieve", explanation: "Relieve symptoms: Giảm triệu chứng." },
  { id: 153, type: QuestionType.FILL_IN_BLANK, questionText: "He used to cook lunch _ _ _  the British Prime Minister.", correctAnswer: "for", explanation: "Cook for: Nấu cho." },
  { id: 154, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Our school", "has three floors", "classroom", "is on the first floor.", "and my"], correctAnswer: "Our school has three floors and my classroom is on the first floor.", explanation: "Trường tôi có 3 tầng và lớp tôi ở tầng 1." },
  { id: 155, type: QuestionType.MULTIPLE_CHOICE, questionText: "There is a meeting … 9 am and 2 pm.", options: ["on", "between", "till", "at"], correctAnswer: "between", explanation: "Between... and..." },
  { id: 156, type: QuestionType.MULTIPLE_CHOICE, questionText: "My sister is … at cooking than I am.", options: ["good", "well", "better", "badly"], correctAnswer: "better", explanation: "Better at: Giỏi hơn." },
  { id: 157, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has different stress pattern:", options: ["sample", "champagne", "remote", "relax"], correctAnswer: "sample", explanation: "'Sample' nhấn âm 1, các từ còn lại nhấn âm 2." },
  { id: 158, type: QuestionType.MULTIPLE_CHOICE, questionText: "______ Van Hau plays football!", options: ["What skilful", "What skilfully", "How skilful", "How skilfully"], correctAnswer: "How skilfully", explanation: "How + adv + S + V!" },
  { id: 159, type: QuestionType.FILL_IN_BLANK, questionText: "What is that little light in the sky in the evening? – It’s s_ _ _ _ .", correctAnswer: "tars", explanation: "Stars: Sao." },
  { id: 160, type: QuestionType.FILL_IN_BLANK, questionText: "The police asked them what had happened the night be_ _ _ _ .", correctAnswer: "fore", explanation: "The night before." },
  { id: 161, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently.", options: ["letter", "twelve", "person", "sentence"], correctAnswer: "person", explanation: "'Person' /ɜː/, các từ còn lại /e/." },
  { id: 162, type: QuestionType.FILL_IN_BLANK, questionText: "We can protect our environment by _ _ _ _ _ _ _ _ _ _  pollution.", correctAnswer: "minimizing", explanation: "Minimizing: Giảm thiểu." },
  { id: 163, type: QuestionType.FILL_IN_BLANK, questionText: "By _ _ _ _  was this story written?", correctAnswer: "whom", explanation: "By whom: Bởi ai." },
  { id: 164, type: QuestionType.FILL_IN_BLANK, questionText: "She doesn’t enjoy looking _ _ _ _ _  the children.", correctAnswer: "after", explanation: "Looking after: Chăm sóc." },
  { id: 165, type: QuestionType.FILL_IN_BLANK, questionText: "Columbus discovered America in the 15th _ _ _ _ _ _ _ .", correctAnswer: "century", explanation: "Century: Thế kỷ." },
  { id: 166, type: QuestionType.MULTIPLE_CHOICE, questionText: "My uncle is a heavy smoker. He gets ... a lot.", options: ["used to smoke", "used to smoking", "use to smoke", "use to smoking"], correctAnswer: "used to smoking", explanation: "Get used to + V-ing." },
  { id: 167, type: QuestionType.FILL_IN_BLANK, questionText: "If that hat costs much, I _ _ _ _  buy a smaller one.", correctAnswer: "will", explanation: "Câu điều kiện loại 1." },
  { id: 168, type: QuestionType.FILL_IN_BLANK, questionText: "Pompeii was destroyed when the _ _ _ _ _ _ _  erupted in 79 AD.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/8/636168156867913086_Audio.mp3"), correctAnswer: "volcano", explanation: "Volcano: Núi lửa." },
  { id: 169, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to tell you", "that we are", "you next weekend.", "I am calling", "coming to visit"], correctAnswer: "I am calling to tell you that we are coming to visit you next weekend.", explanation: "Tôi gọi để báo là chúng tôi sẽ đến thăm bạn cuối tuần tới." },
  { id: 170, type: QuestionType.FILL_IN_BLANK, questionText: "He is delighted _ _ _ _  you have paid attention to recycling.", correctAnswer: "that", explanation: "Delighted that: Vui vì." },
  { id: 171, type: QuestionType.MULTIPLE_CHOICE, questionText: "He drives very ... and has got two accidents this year.", options: ["careless", "carefully", "carelessly", "careful"], correctAnswer: "carelessly", explanation: "Drive carelessly: Lái xe ẩu." },
  { id: 172, type: QuestionType.MULTIPLE_CHOICE, questionText: "What time does he leave home for work?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/30/636791730655289786_Audio.mp3"), options: ["No later than six thirty.", "No later than seven thirty.", "No later than eight o’clock.", "No later than eight thirty."], correctAnswer: "No later than eight thirty.", explanation: "Nghe audio." },
  { id: 173, type: QuestionType.FILL_IN_BLANK, questionText: "The roads are rough in m_ _ _ _ _ _ _ _ _ _  areas, so it’s hard to travel by road.", correctAnswer: "ountainous", explanation: "Mountainous: Miền núi." },
  { id: 174, type: QuestionType.MULTIPLE_CHOICE, questionText: "How is she? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302344439326451_Audio.mp3"), options: ["She is the prettiest person among them", "She is the happiest person among them", "She is the laziest person among them", "She is the creepiest person among them"], correctAnswer: "She is the happiest person among them", explanation: "Nghe audio." },
  { id: 175, type: QuestionType.FILL_IN_BLANK, questionText: "We can communicate _ _ _ _  people around the world through the Internet.", correctAnswer: "with", explanation: "Communicate with." },
  { id: 176, type: QuestionType.FILL_IN_BLANK, questionText: "There was a scary big _ _ _ _ _  on Christmas Day.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/30/636791797713470806_Audio.mp3"), correctAnswer: "storm", explanation: "Storm: Cơn bão." },
  { id: 177, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["her illness", "serious than", "Unfortunately", "was more", "we thought."], correctAnswer: "Unfortunately her illness was more serious than we thought.", explanation: "Thật không may bệnh tình của cô ấy nghiêm trọng hơn chúng tôi tưởng." },
  { id: 178, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["prefers to have", "eat meat so he", "Cuong doesn’t", "a vegetarian restaurant.", "his meals in"], correctAnswer: "Cuong doesn’t eat meat so he prefers to have his meals in a vegetarian restaurant.", explanation: "Cường không ăn thịt nên anh ấy thích ăn ở nhà hàng chay." },
  { id: 179, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which sentence is correct?", options: ["The drugstore is next the bakery to the park.", "The drugstore is next to the bakery and the park.", "The drugstore is next to the bakery to the park.", "The drugstore is to the bakery next the park."], correctAnswer: "The drugstore is next to the bakery and the park.", explanation: "Next to A and B." },
  { id: 180, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the switch", "was dangerous", "Jane said", "and warned me", "not to touch it."], correctAnswer: "Jane said the switch was dangerous and warned me not to touch it.", explanation: "Jane nói công tắc nguy hiểm và cảnh báo tôi đừng chạm vào." },
  { id: 181, type: QuestionType.FILL_IN_BLANK, questionText: "Are you going to stay at home _ _  New Year's Day?", correctAnswer: "on", explanation: "On New Year's Day." },
  { id: 182, type: QuestionType.MULTIPLE_CHOICE, questionText: "Will you … the door open?", options: ["leave", "allow", "permit", "give"], correctAnswer: "leave", explanation: "Leave open." },
  { id: 183, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _  she saw the dark clouds, she went back to the house to fetch her umbrella.", correctAnswer: "When", explanation: "When she saw..." },
  { id: 184, type: QuestionType.MULTIPLE_CHOICE, questionText: "My grandmother is getting ....", options: ["older", "to be old", "elder", "be old"], correctAnswer: "older", explanation: "Getting older: Già đi." },
  { id: 185, type: QuestionType.FILL_IN_BLANK, questionText: "Singapore is an island city of about three million _ _ _ _ _ _ .", correctAnswer: "people", explanation: "People: Người." },
  { id: 186, type: QuestionType.FILL_IN_BLANK, questionText: "Everyone is going to have to put their shoulder to the _ _ _ el.", correctAnswer: "whe", explanation: "Put shoulder to the wheel: Cố gắng hết sức." },
  { id: 187, type: QuestionType.FILL_IN_BLANK, questionText: "As a se_ _ _ _ _ _  man, Henry always looks calm and makes a wise decision.", correctAnswer: "nsible", explanation: "Sensible: Khôn ngoan." },
  { id: 188, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["destroying forests", "important to", "as they are", "We should stop", "our environment."], correctAnswer: "We should stop destroying forests as they are important to our environment.", explanation: "Chúng ta nên ngừng phá rừng vì chúng quan trọng cho môi trường." },
  { id: 189, type: QuestionType.FILL_IN_BLANK, questionText: "She doesn’t like violent movies, _ _ _ _  she?", correctAnswer: "does", explanation: "Does she: Câu hỏi đuôi." },
  { id: 190, type: QuestionType.MULTIPLE_CHOICE, questionText: "What must he do? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302348579105722_Audio.mp3"), options: ["Lock behind door", "Lock the left-side door", "Lock the front door", "Lock the right-side door"], correctAnswer: "Lock the front door", explanation: "Nghe audio." },
  { id: 191, type: QuestionType.MULTIPLE_CHOICE, questionText: "Who was Marconi? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/13/635303167761660540_Audio.mp3"), options: ["The inventor of radio", "The inventor of TV", "The inventor of car", "The inventor of X-ray"], correctAnswer: "The inventor of radio", explanation: "Nghe audio." },
  { id: 192, type: QuestionType.FILL_IN_BLANK, questionText: "She always dreams of _ _ _ _ _  beautiful and rich.", correctAnswer: "being", explanation: "Dreams of being." },
  { id: 193, type: QuestionType.FILL_IN_BLANK, questionText: "As long as you stay calm, you’ll _ _ _ _  your driving test.", correctAnswer: "pass", explanation: "Pass test: Đậu kỳ thi." },
  { id: 194, type: QuestionType.MULTIPLE_CHOICE, questionText: "Do you have any brothers or sisters? – No, I’m ... only child in my family.", options: ["the", "a", "this", "Ø"], correctAnswer: "the", explanation: "The only child: Con một." },
  { id: 195, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which part needs correction in the following sentence? Linda and me are going to participate in the music club.", options: ["me", "to", "are", "in"], correctAnswer: "me", explanation: "Sửa thành 'I' (Chủ ngữ)." },
  { id: 196, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the poor.", "advise me", "My parents", "always", "to help"], correctAnswer: "My parents always advise me to help the poor.", explanation: "Bố mẹ luôn khuyên tôi giúp đỡ người nghèo." },
  { id: 197, type: QuestionType.FILL_IN_BLANK, questionText: "The weather _ _ _ _ _ _ _  us in so many ways.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241444742604599_Audio.mp3"), correctAnswer: "affects", explanation: "Affects: Ảnh hưởng." },
  { id: 198, type: QuestionType.MULTIPLE_CHOICE, questionText: "I’m ... that you would like to join in this English Speaking Club.", options: ["pleasure", "please", "pleased", "pleasingly"], correctAnswer: "pleased", explanation: "Pleased: Vui lòng." },
  { id: 199, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the race.", "In spite of", "a pain", "Jill finished", "in her leg,"], correctAnswer: "In spite of a pain in her leg, Jill finished the race.", explanation: "Mặc dù đau chân, Jill vẫn hoàn thành cuộc đua." },
  { id: 200, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["all the toys", "on the floor.", "He took", "out of the box", "and left them"], correctAnswer: "He took all the toys out of the box and left them on the floor.", explanation: "Cậu bé lấy hết đồ chơi ra khỏi hộp và để trên sàn." }
];

        // --- 3. HELPER COMPONENTS ---

        const AudioPlayer = ({ src }) => {
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(false);

            useEffect(() => {
                setIsPlaying(false);
                if (audioRef.current) {
                    audioRef.current.load();
                }
            }, [src]);

            const togglePlay = () => {
                if (audioRef.current) {
                    if (isPlaying) {
                        audioRef.current.pause();
                    } else {
                        audioRef.current.play();
                    }
                    setIsPlaying(!isPlaying);
                }
            };

            return (
                <div className="flex items-center space-x-2 mt-4 mb-2 bg-blue-50 p-2 rounded-lg border border-blue-100 w-fit">
                    <button
                        onClick={togglePlay}
                        className={`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${isPlaying ? 'bg-red-500 hover:bg-red-600' : 'bg-blue-500 hover:bg-blue-600'} text-white shadow-sm`}
                        aria-label={isPlaying ? "Pause audio" : "Play audio"}
                    >
                        {isPlaying ? (
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clipRule="evenodd" />
                            </svg>
                        ) : (
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clipRule="evenodd" />
                            </svg>
                        )}
                    </button>
                    <span className="text-sm text-blue-800 font-medium">Listen to the question</span>
                    <audio ref={audioRef} src={src} onEnded={() => setIsPlaying(false)} className="hidden" />
                </div>
            );
        };

        const ProgressBar = ({ current, total }) => {
            const progress = Math.min(100, Math.max(0, ((current) / total) * 100));

            return (
                <div className="w-full max-w-3xl mx-auto mb-6 px-4 md:px-0">
                    <div className="flex justify-between text-xs font-bold text-slate-500 mb-1 uppercase tracking-wider">
                        <span>Progress</span>
                        <span>{current} / {total}</span>
                    </div>
                    <div className="h-3 bg-slate-200 rounded-full overflow-hidden">
                        <div
                            className="h-full bg-blue-500 transition-all duration-500 ease-out rounded-full"
                            style={{ width: `${progress}%` }}
                        ></div>
                    </div>
                </div>
            );
        };

        const QuestionNavigation = ({ questions, answers, currentIndex, onSelectQuestion }) => {
            return (
                <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 mt-6 w-full max-w-3xl">
                    <h3 className="text-sm font-bold text-slate-500 uppercase tracking-wider mb-3">
                        Question Map
                    </h3>
                    <div className="flex flex-wrap gap-2 max-h-40 overflow-y-auto custom-scrollbar">
                        {questions.map((q, idx) => {
                            const result = answers[q.id];
                            let btnClass = "w-8 h-8 md:w-10 md:h-10 text-xs md:text-sm font-bold rounded-lg flex items-center justify-center transition-all ";

                            if (idx === currentIndex) {
                                btnClass += "ring-2 ring-offset-2 ring-blue-500 ";
                            }

                            if (result) {
                                if (result.isCorrect) {
                                    btnClass += "bg-green-100 text-green-700 border border-green-200 hover:bg-green-200";
                                } else {
                                    btnClass += "bg-red-100 text-red-700 border border-red-200 hover:bg-red-200";
                                }
                            } else {
                                btnClass += "bg-slate-100 text-slate-500 border border-slate-200 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200";
                            }

                            return (
                                <button
                                    key={q.id}
                                    onClick={() => onSelectQuestion(idx)}
                                    className={btnClass}
                                >
                                    {idx + 1}
                                </button>
                            );
                        })}
                    </div>
                    <div className="flex gap-4 mt-3 text-xs text-slate-500 font-medium">
                        <div className="flex items-center"><span className="w-3 h-3 bg-green-100 border border-green-200 rounded mr-1"></span> Correct</div>
                        <div className="flex items-center"><span className="w-3 h-3 bg-red-100 border border-red-200 rounded mr-1"></span> Incorrect</div>
                        <div className="flex items-center"><span className="w-3 h-3 bg-slate-100 border border-slate-200 rounded mr-1"></span> Unanswered</div>
                    </div>
                </div>
            );
        };

        // --- 4. MAIN COMPONENTS ---

        const StartScreen = ({ onStart, totalQuestions }) => {
            const [name, setName] = useState('');

            const handleSubmit = () => {
                if (name.trim()) {
                    onStart(name.trim());
                }
            };

            return (
                <div className="flex flex-col items-center justify-center min-h-[60vh] p-8 text-center animate-fade-in">
                    <div className="bg-white p-10 rounded-3xl shadow-2xl max-w-lg w-full">
                        <div className="w-24 h-24 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg animate-bounce-short">
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-12 w-12 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                            </svg>
                        </div>

                        <h1 className="text-3xl md:text-4xl font-extrabold text-slate-800 mb-2">
                            IOE English Master
                        </h1>
                        <p className="text-slate-500 text-lg mb-6 font-medium">
                            Grade 8 - Exam #04
                        </p>

                        <div className="text-left bg-slate-50 p-6 rounded-xl border border-slate-100 mb-6">
                            <label htmlFor="playerName" className="block text-sm font-bold text-slate-700 mb-2">
                                Enter your name to start:
                            </label>
                            <input
                                type="text"
                                id="playerName"
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                onKeyDown={(e) => e.key === 'Enter' && handleSubmit()}
                                placeholder="Your Name (e.g. Nguyen Van A)"
                                className="w-full px-4 py-3 rounded-lg border-2 border-slate-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 outline-none transition-all font-bold text-slate-800 placeholder-slate-400"
                                autoFocus
                            />
                        </div>

                        <div className="space-y-4 mb-8 text-left text-sm text-slate-600 px-2">
                            <div className="flex items-center">
                                <span className="w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-3 text-xs font-bold">1</span>
                                <span>Answer <strong>{totalQuestions} questions</strong> (10 points each)</span>
                            </div>
                            <div className="flex items-center">
                                <span className="w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center mr-3 text-xs font-bold">2</span>
                                <span>Learn from detailed explanations</span>
                            </div>
                        </div>

                        <button
                            onClick={handleSubmit}
                            disabled={!name.trim()}
                            className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg transform transition hover:scale-[1.02] active:scale-95 text-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none"
                        >
                            Start Exam
                        </button>
                    </div>
                </div>
            );
        };

        const ResultScreen = ({ playerName, score, points, total, results, onRestart, onRetryWrong }) => {
            const percentage = total > 0 ? Math.round((score / total) * 100) : 0;
            const wrongCount = total - score;

            let message = "Good effort!";
            let color = "text-blue-600";

            if (percentage >= 90) {
                message = "Outstanding!";
                color = "text-yellow-400";
            } else if (percentage >= 70) {
                message = "Great Job!";
                color = "text-green-400";
            } else if (percentage < 50) {
                message = "Keep Practicing!";
                color = "text-slate-300";
            }

            return (
                <div className="flex flex-col items-center justify-center p-4 animate-fade-in max-w-2xl mx-auto w-full mb-10">
                    <div className="bg-white rounded-3xl shadow-2xl w-full overflow-hidden">
                        <div className="bg-slate-900 p-8 text-center text-white relative overflow-hidden">
                            {/* Background decoration */}
                            <div className="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
                                <div className="absolute top-[-50%] left-[-50%] w-[200%] h-[200%] bg-gradient-to-tr from-blue-500 to-purple-500 rotate-12"></div>
                            </div>

                            <h2 className="text-2xl md:text-3xl font-bold mb-2 relative z-10">{message} {playerName}!</h2>
                            <div className={`text-6xl font-extrabold mb-2 relative z-10 ${color}`}>
                                {points} <span className="text-2xl font-bold text-white opacity-80">pts</span>
                            </div>
                            <p className="text-slate-300 relative z-10">You answered {score} out of {total} correctly</p>
                        </div>

                        <div className="p-8">
                            <div className="grid grid-cols-2 gap-4 mb-8">
                                <div className="bg-green-50 p-4 rounded-xl border border-green-100 text-center">
                                    <span className="block text-2xl font-bold text-green-700">{score}</span>
                                    <span className="text-xs font-bold text-green-600 uppercase tracking-wider">Correct</span>
                                </div>
                                <div className="bg-red-50 p-4 rounded-xl border border-red-100 text-center">
                                    <span className="block text-2xl font-bold text-red-700">{wrongCount}</span>
                                    <span className="text-xs font-bold text-red-600 uppercase tracking-wider">Incorrect</span>
                                </div>
                            </div>

                            <div className="space-y-3 mb-6">
                                <button
                                    onClick={onRestart}
                                    className="w-full bg-slate-900 hover:bg-slate-800 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition-transform active:scale-95"
                                >
                                    Restart Full Exam
                                </button>

                                {wrongCount > 0 && (
                                    <button
                                        onClick={onRetryWrong}
                                        className="w-full bg-white border-2 border-red-100 text-red-600 hover:bg-red-50 hover:border-red-200 font-bold py-4 px-8 rounded-xl transition-transform active:scale-95"
                                    >
                                        Retry Incorrect Answers ({wrongCount})
                                    </button>
                                )}
                            </div>

                            <div className="border-t pt-6">
                                <h3 className="font-bold text-gray-700 mb-4">Question Summary</h3>
                                <div className="space-y-3 max-h-64 overflow-y-auto custom-scrollbar pr-2">
                                    {results.map((res, index) => (
                                        <div key={index} className={`flex items-start p-3 rounded-lg text-sm ${res.isCorrect ? 'bg-green-50' : 'bg-red-50'}`}>
                                            <span className={`font-bold mr-3 ${res.isCorrect ? 'text-green-600' : 'text-red-600'}`}>#{index + 1}</span>
                                            <div className="flex-1">
                                                <p className="text-gray-800 mb-1 font-medium truncate">{res.userAnswer || "(No Answer)"}</p>
                                                {!res.isCorrect && (
                                                    <div className="mt-1">
                                                        <p className="text-xs text-gray-500 uppercase font-semibold">Correct Answer:</p>
                                                        <p className="text-green-600 font-medium">{res.correctAnswer}</p>
                                                    </div>
                                                )}
                                            </div>
                                            <div className="ml-2">
                                                {res.isCorrect ? (
                                                    <svg className="w-5 h-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>
                                                ) : (
                                                    <svg className="w-5 h-5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
                                                )}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const QuestionCard = ({
            question,
            onAnswerSubmit,
            showFeedback,
            userAnswer
        }) => {
            const [inputValue, setInputValue] = useState('');
            const [rearrangeOrder, setRearrangeOrder] = useState([]);
            const [availableParts, setAvailableParts] = useState([]);
            const [isHintVisible, setIsHintVisible] = useState(false);

            useEffect(() => {
                setInputValue('');
                setIsHintVisible(false);

                if (question.type === QuestionType.REARRANGE && question.rearrangeParts) {
                    setRearrangeOrder([]);
                    setAvailableParts([...question.rearrangeParts]);
                }
                if (userAnswer) {
                    if (question.type !== QuestionType.REARRANGE) {
                        setInputValue(userAnswer);
                    }
                }
            }, [question, userAnswer, showFeedback]);

            const handleSubmit = () => {
                if (showFeedback) return;

                let finalAnswer = '';
                if (question.type === QuestionType.MULTIPLE_CHOICE) {
                    finalAnswer = inputValue;
                } else if (question.type === QuestionType.FILL_IN_BLANK) {
                    finalAnswer = inputValue.trim();
                } else if (question.type === QuestionType.REARRANGE) {
                    finalAnswer = rearrangeOrder.join(' ');
                }

                if (finalAnswer) {
                    onAnswerSubmit(finalAnswer);
                }
            };

            const handleOptionClick = (option) => {
                if (showFeedback) return;
                setInputValue(option);
                onAnswerSubmit(option);
            };

            const handleRearrangeClick = (word, fromAvailable) => {
                if (showFeedback) return;

                if (fromAvailable) {
                    setAvailableParts(prev => prev.filter(w => w !== word));
                    setRearrangeOrder(prev => [...prev, word]);
                } else {
                    setRearrangeOrder(prev => prev.filter(w => w !== word));
                    setAvailableParts(prev => [...prev, word]);
                }
            };

            const isCorrect = userAnswer?.toLowerCase().trim() === question.correctAnswer.toLowerCase().trim();

            return (
                <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 max-w-3xl w-full mx-auto animate-fade-in relative overflow-hidden flex flex-col">
                    <div className="mb-6">
                        <div className="flex justify-between items-start mb-4">
                            <div className="flex gap-2 flex-wrap">
                                <span className="inline-block px-3 py-1 text-xs font-bold tracking-wider text-blue-600 bg-blue-100 rounded-full mb-2">
                                    QUESTION {question.id}
                                </span>
                                {!showFeedback && (
                                    <button
                                        onClick={() => setIsHintVisible(!isHintVisible)}
                                        className={`inline-flex items-center px-3 py-1 text-xs font-bold tracking-wider rounded-full mb-2 transition-colors ${isHintVisible
                                            ? 'bg-yellow-200 text-yellow-800'
                                            : 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'
                                            }`}
                                    >
                                        <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z" /></svg>
                                        {isHintVisible ? 'Hide Hint' : 'Show Hint'}
                                    </button>
                                )}
                            </div>
                            {question.type === QuestionType.REARRANGE && (
                                <span className="text-xs text-gray-400 font-medium whitespace-nowrap ml-2">Tap words to arrange</span>
                            )}
                        </div>

                        {isHintVisible && !showFeedback && (
                            <div className="mb-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg animate-fade-in">
                                <p className="text-sm text-yellow-800 font-bold mb-1 flex items-center">
                                    <svg className="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    Gợi ý (Hint):
                                </p>
                                <p className="text-sm text-yellow-900 italic leading-relaxed">
                                    {question.explanation}
                                </p>
                            </div>
                        )}

                        <h2 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 leading-relaxed">
                            {question.questionText}
                        </h2>

                        {question.imageUrl && (
                            <div className="mb-6 rounded-xl overflow-hidden border border-gray-100 shadow-sm bg-gray-50 flex justify-center p-2">
                                <img
                                    src={question.imageUrl}
                                    alt={`Illustration for question ${question.id}`}
                                    className="max-w-full h-auto max-h-[300px] object-contain rounded-lg"
                                    loading="lazy"
                                />
                            </div>
                        )}

                        {question.audioUrl && (
                            <div className="flex justify-center mb-6">
                                <AudioPlayer src={question.audioUrl} />
                            </div>
                        )}
                    </div>

                    <div className="mb-8 flex-grow">
                        {question.type === QuestionType.MULTIPLE_CHOICE && question.options && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                {question.options.map((option, idx) => {
                                    let btnClass = "w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex items-center shadow-sm ";
                                    if (showFeedback) {
                                        if (option === question.correctAnswer) {
                                            btnClass += "border-green-500 bg-green-50 text-green-800 font-bold shadow-green-100";
                                        } else if (option === userAnswer && option !== question.correctAnswer) {
                                            btnClass += "border-red-500 bg-red-50 text-red-800 opacity-80 shadow-red-100";
                                        } else {
                                            btnClass += "border-gray-100 text-gray-400 opacity-50 bg-gray-50";
                                        }
                                    } else {
                                        btnClass += "border-gray-200 hover:border-blue-400 hover:bg-blue-50 text-gray-700 bg-white hover:shadow-md";
                                    }

                                    return (
                                        <button
                                            key={idx}
                                            onClick={() => handleOptionClick(option)}
                                            disabled={showFeedback}
                                            className={btnClass}
                                        >
                                            <div className={`w-8 h-8 rounded-full border-2 mr-3 flex-shrink-0 flex items-center justify-center font-bold text-sm ${showFeedback && option === question.correctAnswer ? 'border-green-500 bg-green-500 text-white' :
                                                showFeedback && option === userAnswer ? 'border-red-500 bg-red-500 text-white' :
                                                    'border-gray-300 text-gray-500'
                                                }`}>
                                                {['A', 'B', 'C', 'D'][idx]}
                                            </div>
                                            <span className="flex-grow">{option}</span>
                                        </button>
                                    );
                                })}
                            </div>
                        )}

                        {question.type === QuestionType.FILL_IN_BLANK && (
                            <div className="relative max-w-lg mx-auto">
                                <input
                                    type="text"
                                    value={inputValue}
                                    onChange={(e) => setInputValue(e.target.value)}
                                    onKeyDown={(e) => e.key === 'Enter' && handleSubmit()}
                                    disabled={showFeedback}
                                    placeholder="Type your answer..."
                                    className={`w-full p-4 pl-6 text-lg border-2 rounded-xl focus:outline-none transition-all shadow-sm ${showFeedback
                                        ? isCorrect
                                            ? 'border-green-500 bg-green-50 text-green-800 font-bold'
                                            : 'border-red-500 bg-red-50 text-red-800 font-bold'
                                        : 'border-gray-200 focus:border-blue-500 text-gray-800 focus:shadow-md'
                                        }`}
                                />
                                {!showFeedback && (
                                    <button
                                        onClick={handleSubmit}
                                        disabled={!inputValue.trim()}
                                        className="absolute right-2 top-2 bottom-2 bg-blue-600 text-white px-6 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                                    >
                                        Submit
                                    </button>
                                )}
                            </div>
                        )}

                        {question.type === QuestionType.REARRANGE && (
                            <div className="space-y-6">
                                <div className={`min-h-[100px] p-5 rounded-xl border-2 flex flex-wrap gap-2 items-center content-start transition-colors ${showFeedback
                                    ? isCorrect
                                        ? 'border-green-500 bg-green-50'
                                        : 'border-red-500 bg-red-50'
                                    : 'border-blue-200 bg-blue-50/50'
                                    }`}>
                                    {rearrangeOrder.length === 0 && !showFeedback && (
                                        <span className="text-gray-400 w-full text-center py-4 italic">Tap words below to build sentence...</span>
                                    )}
                                    {rearrangeOrder.map((word, idx) => (
                                        <button
                                            key={`${word}-${idx}`}
                                            onClick={() => handleRearrangeClick(word, false)}
                                            disabled={showFeedback}
                                            className="bg-white border border-blue-200 text-blue-800 px-3 py-2 rounded-lg shadow-sm hover:bg-red-50 hover:border-red-200 hover:text-red-600 transition-colors font-medium animate-fade-in"
                                        >
                                            {word}
                                        </button>
                                    ))}
                                </div>

                                {!showFeedback && (
                                    <div className="flex flex-wrap gap-2 justify-center p-4 bg-gray-50 rounded-xl border border-gray-100">
                                        {availableParts.map((word, idx) => (
                                            <button
                                                key={`${word}-${idx}`}
                                                onClick={() => handleRearrangeClick(word, true)}
                                                className="bg-white border border-gray-200 text-gray-700 px-4 py-2 rounded-lg shadow-sm hover:border-blue-400 hover:text-blue-600 hover:shadow-md hover:-translate-y-0.5 active:scale-95 transition-all"
                                            >
                                                {word}
                                            </button>
                                        ))}
                                    </div>
                                )}

                                {!showFeedback && (
                                    <div className="flex justify-center mt-4">
                                        <button
                                            onClick={handleSubmit}
                                            disabled={rearrangeOrder.length === 0}
                                            className="bg-blue-600 text-white py-3 px-10 rounded-xl font-bold hover:bg-blue-700 shadow-lg disabled:opacity-50 disabled:shadow-none transition-all transform hover:scale-105"
                                        >
                                            Submit Answer
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>

                    {showFeedback && (
                        <div className={`mt-auto p-5 rounded-xl border-l-4 animate-slide-up shadow-sm ${isCorrect ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'
                            }`}>
                            <div className="flex items-center mb-3">
                                <div className={`p-1.5 rounded-full mr-3 ${isCorrect ? 'bg-green-200 text-green-700' : 'bg-red-200 text-red-700'}`}>
                                    {isCorrect ? (
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" /></svg>
                                    ) : (
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M6 18L18 6M6 6l12 12" /></svg>
                                    )}
                                </div>
                                <h3 className={`text-lg font-bold ${isCorrect ? 'text-green-800' : 'text-red-800'}`}>
                                    {isCorrect ? 'Correct!' : 'Incorrect'}
                                </h3>
                            </div>

                            {!isCorrect && (
                                <div className="mb-4 text-red-800 bg-red-100/50 p-3 rounded-lg border border-red-100">
                                    <span className="font-bold text-xs uppercase tracking-wide opacity-70 mb-1 block">Correct Answer</span>
                                    <p className="font-semibold text-lg">{question.correctAnswer}</p>
                                </div>
                            )}

                            <div className="text-gray-700 pt-2">
                                <span className="font-bold text-xs uppercase tracking-wide text-gray-500 mb-1 block">Explanation</span>
                                <p className="leading-relaxed">{question.explanation}</p>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const App = () => {
            const [gameState, setGameState] = useState(GameState.START);
            const [playerName, setPlayerName] = useState('');

            const [activeQuestions, setActiveQuestions] = useState(QUIZ_DATA);
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);

            const [answers, setAnswers] = useState({});

            const [showFeedback, setShowFeedback] = useState(false);

            const currentQuestion = activeQuestions[currentQuestionIndex];
            const totalQuestions = activeQuestions.length;
            const answeredCount = Object.keys(answers).length;

            const correctCount = Object.values(answers).filter(a => a.isCorrect).length;
            const currentPoints = correctCount * 10;

            const handleStartGame = (name) => {
                if (typeof name === 'string' && name.trim()) {
                    setPlayerName(name);
                }
                setActiveQuestions(QUIZ_DATA);
                setGameState(GameState.PLAYING);
                setCurrentQuestionIndex(0);
                setAnswers({});
                setShowFeedback(false);
            };

            const handleRestart = () => {
                handleStartGame();
            }

            const handleRetryWrong = () => {
                const wrongQuestionIds = activeQuestions
                    .filter(q => {
                        const ans = answers[q.id];
                        return !ans || !ans.isCorrect;
                    })
                    .map(q => q.id);

                const wrongQuestions = QUIZ_DATA.filter(q => wrongQuestionIds.includes(q.id));

                if (wrongQuestions.length === 0) {
                    handleStartGame();
                    return;
                }

                setActiveQuestions(wrongQuestions);
                setGameState(GameState.PLAYING);
                setCurrentQuestionIndex(0);
                setAnswers({});
                setShowFeedback(false);
            };

            const handleAnswerSubmit = (answer) => {
                const isCorrect = answer.toLowerCase().trim() === currentQuestion.correctAnswer.toLowerCase().trim();

                const result = {
                    questionId: currentQuestion.id,
                    isCorrect,
                    userAnswer: answer,
                    correctAnswer: currentQuestion.correctAnswer
                };

                setAnswers(prev => ({
                    ...prev,
                    [currentQuestion.id]: result
                }));

                setShowFeedback(true);
            };

            const jumpToQuestion = (index) => {
                setCurrentQuestionIndex(index);
                const targetQ = activeQuestions[index];
                if (answers[targetQ.id]) {
                    setShowFeedback(true);
                } else {
                    setShowFeedback(false);
                }
            };

            const handleNextQuestion = () => {
                if (currentQuestionIndex < totalQuestions - 1) {
                    jumpToQuestion(currentQuestionIndex + 1);
                } else {
                    if (answeredCount === totalQuestions) {
                        setGameState(GameState.FINISHED);
                    } else {
                        const firstUnanswered = activeQuestions.findIndex(q => !answers[q.id]);
                        if (firstUnanswered !== -1) {
                            jumpToQuestion(firstUnanswered);
                        } else {
                            setGameState(GameState.FINISHED);
                        }
                    }
                }
            };

            const handleFinish = () => {
                setGameState(GameState.FINISHED);
            }

            useEffect(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, [currentQuestionIndex, gameState]);

            return (
                <div className="min-h-screen bg-slate-100 font-sans text-slate-800 flex flex-col">
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-20 shadow-sm">
                        <div className="max-w-5xl mx-auto px-4 py-3 flex justify-between items-center">
                            <div className="flex items-center space-x-2">
                                <div className="bg-blue-600 text-white p-1.5 rounded-lg shadow-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                                    </svg>
                                </div>
                                <h1 className="font-bold text-lg hidden sm:block">IOE Master</h1>
                            </div>

                            {gameState === GameState.PLAYING && (
                                <div className="flex items-center gap-4">
                                    {playerName && (
                                        <div className="hidden sm:flex items-center text-sm font-bold text-slate-500 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-200">
                                            <svg className="w-4 h-4 mr-2 opacity-50" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clipRule="evenodd"></path></svg>
                                            {playerName}
                                        </div>
                                    )}
                                    <div className="bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-100 flex items-center">
                                        <span className="text-xs text-blue-600 font-bold uppercase mr-2">Points</span>
                                        <span className="text-lg font-extrabold text-blue-700">{currentPoints}</span>
                                    </div>
                                    <button
                                        onClick={handleFinish}
                                        className="text-xs font-bold text-slate-500 hover:text-red-500 uppercase tracking-wide px-2"
                                    >
                                        Finish
                                    </button>
                                </div>
                            )}
                        </div>
                    </header>

                    <main className="flex-grow flex flex-col items-center justify-center p-4 md:p-6 w-full max-w-5xl mx-auto">

                        {gameState === GameState.START && (
                            <StartScreen onStart={handleStartGame} totalQuestions={QUIZ_DATA.length} />
                        )}

                        {gameState === GameState.PLAYING && currentQuestion && (
                            <div className="w-full flex flex-col items-center pb-20 md:pb-0">
                                <ProgressBar current={currentQuestionIndex + 1} total={totalQuestions} />

                                <QuestionCard
                                    key={currentQuestion.id}
                                    question={currentQuestion}
                                    onAnswerSubmit={handleAnswerSubmit}
                                    showFeedback={showFeedback}
                                    userAnswer={answers[currentQuestion.id]?.userAnswer || null}
                                />

                                <QuestionNavigation
                                    questions={activeQuestions}
                                    answers={answers}
                                    currentIndex={currentQuestionIndex}
                                    onSelectQuestion={jumpToQuestion}
                                />

                                {showFeedback && (
                                    <div className="fixed bottom-0 left-0 w-full p-4 bg-white border-t border-gray-200 md:relative md:bg-transparent md:border-0 md:p-0 md:mt-6 z-30 flex justify-center animate-slide-up shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] md:shadow-none">
                                        <button
                                            onClick={handleNextQuestion}
                                            className="w-full md:w-auto bg-slate-900 hover:bg-slate-800 text-white text-lg font-bold py-3 px-12 rounded-xl shadow-xl transition-transform active:scale-95 flex items-center justify-center"
                                        >
                                            <span>
                                                {currentQuestionIndex === totalQuestions - 1 && answeredCount === totalQuestions
                                                    ? "Finish Exam"
                                                    : "Next Question"}
                                            </span>
                                            <svg className="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" />
                                            </svg>
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}

                        {gameState === GameState.FINISHED && (
                            <ResultScreen
                                playerName={playerName}
                                score={correctCount}
                                points={currentPoints}
                                total={totalQuestions}
                                results={activeQuestions.map(q => answers[q.id] || {
                                    questionId: q.id,
                                    isCorrect: false,
                                    userAnswer: '',
                                    correctAnswer: q.correctAnswer
                                })}
                                onRestart={handleRestart}
                                onRetryWrong={handleRetryWrong}
                            />
                        )}

                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>